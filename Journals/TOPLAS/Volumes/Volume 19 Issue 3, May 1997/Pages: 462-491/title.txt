Optimal control dependence computation and the Roman chariots problem