A self-applicable partial evaluator for the lambda calculus: correctness and pragmatics