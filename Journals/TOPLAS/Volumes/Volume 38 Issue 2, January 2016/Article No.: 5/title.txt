Compiler-Driven Software Speculation for Thread-Level Parallelism