Total correctness by local improvement in the transformation of functional programs