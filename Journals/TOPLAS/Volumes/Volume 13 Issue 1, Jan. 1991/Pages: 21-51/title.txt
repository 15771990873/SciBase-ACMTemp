Compilation of functional languages by program transformation