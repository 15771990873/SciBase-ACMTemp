CCured: type-safe retrofitting of legacy software