A Transformation Framework for Optimizing Task-Parallel Programs