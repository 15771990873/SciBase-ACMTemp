Optimization of functional programs by grammar thinning