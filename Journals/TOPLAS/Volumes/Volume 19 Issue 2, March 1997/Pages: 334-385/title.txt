Formally based profiling for higher-order functional languages