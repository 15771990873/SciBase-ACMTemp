Program optimization and parallelization using idioms