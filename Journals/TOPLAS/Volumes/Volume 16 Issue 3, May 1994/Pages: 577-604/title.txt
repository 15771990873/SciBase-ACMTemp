A compiler approach to scalable concurrent-program design