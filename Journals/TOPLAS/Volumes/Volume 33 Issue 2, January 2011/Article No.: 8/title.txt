Refinement types for secure implementations