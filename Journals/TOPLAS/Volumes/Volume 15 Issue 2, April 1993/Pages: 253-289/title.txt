Type inference with polymorphic recursion