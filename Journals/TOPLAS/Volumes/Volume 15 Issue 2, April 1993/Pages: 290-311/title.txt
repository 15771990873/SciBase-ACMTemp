Type reconstruction in the presence of polymorphic recursion