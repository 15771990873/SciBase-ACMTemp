Using types to analyze and optimize object-oriented programs