Compiling nested data-parallel programs for shared-memory multiprocessors