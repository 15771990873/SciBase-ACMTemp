An incremental algorithm for satisfying hierarchies of multiway dataflow constraints