A tail-recursive machine with stack inspection