Specification and dialogue control of visual interaction through visual rewriting systems