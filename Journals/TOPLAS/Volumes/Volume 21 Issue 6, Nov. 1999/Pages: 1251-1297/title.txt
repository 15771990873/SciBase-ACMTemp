A global communication optimization technique based on data-flow analysis and linear algebra