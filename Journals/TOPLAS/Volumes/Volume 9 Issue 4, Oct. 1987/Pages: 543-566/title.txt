Efficient algorithms for automatic construction and compactification of parsing