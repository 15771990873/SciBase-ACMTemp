Denali: A practical algorithm for generating optimal code