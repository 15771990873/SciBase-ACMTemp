An efficient on-the-fly cycle collection