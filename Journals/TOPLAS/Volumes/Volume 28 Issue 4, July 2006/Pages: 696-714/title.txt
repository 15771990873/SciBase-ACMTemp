Fast partial evaluation of pattern matching in strings