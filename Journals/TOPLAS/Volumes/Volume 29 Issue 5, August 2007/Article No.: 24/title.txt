BI-hyperdoctrines, higher-order separation logic, and abstraction