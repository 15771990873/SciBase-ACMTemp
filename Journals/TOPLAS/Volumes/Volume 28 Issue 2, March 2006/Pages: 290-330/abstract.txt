We develop a semantics theory for SAP, a variant of Levi and Sangiorgi's Safe Ambients, SA.The dynamics of SA relies uponcapabilities(andco-capabilities) exercised bymobile agents, calledambients, to interact with each other. These capabilities contain references, the names of ambients with which they wish to interact. In SAP we generalize the notion of capability: in order to interact with an ambientn, an ambientmmust exercise a capability indicating bothnand a passwordhto accessn; the interaction betweennandmtakes place only ifnis willing to perform a corresponding co-capability with the same passwordh. The namehcan also be looked upon as aporttoaccess ambient n via port h.In SAP, by managing passwords/ports, for example generating new ones and distributing them selectively, an ambient may now program who may migrate into its computation space, and when. Moreover in SAP, an ambient may provide different services/resources depending on the port accessed by the incoming clients. Then we give anlts-based operational semantics for SAP and a labelledbisimulationequivalence, which is proved to coincide withreduction barbed congruence.We use our notion of bisimulation to prove a set of algebraic laws that are subsequently exploited to prove more significant examples.