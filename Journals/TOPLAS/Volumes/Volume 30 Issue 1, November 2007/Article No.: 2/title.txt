Forma: A framework for safe automatic array reshaping