Efficient dynamic dispatching with type slicing