Automated Classification of Data Races Under Both Strong and Weak Memory Models