Modular typechecking for hierarchically extensible datatypes and functions