Type-Safe linking with recursive DLLs and shared libraries