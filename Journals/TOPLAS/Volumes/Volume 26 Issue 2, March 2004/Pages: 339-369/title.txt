Modular refinement of hierarchic reactive machines