Hancock: A language for analyzing transactional data streams