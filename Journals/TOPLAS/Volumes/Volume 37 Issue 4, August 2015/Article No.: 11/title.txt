Affine Refinement Types for Secure Distributed Programming