Identifying loops in almost linear time