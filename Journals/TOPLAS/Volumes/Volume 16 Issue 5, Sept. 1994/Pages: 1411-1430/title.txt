Polymorphic type inference and abstract data types