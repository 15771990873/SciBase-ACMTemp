Efficiently counting program events with support for on-line queries