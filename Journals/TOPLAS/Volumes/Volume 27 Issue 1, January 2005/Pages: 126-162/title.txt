Automatic discovery of covariant read-only fields