Personalized tag recommendation based on generalized rules