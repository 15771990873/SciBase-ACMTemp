Nanites: an approach to structure-based monitoring