A Framework for Identifying Compromised Nodes in Wireless Sensor Networks