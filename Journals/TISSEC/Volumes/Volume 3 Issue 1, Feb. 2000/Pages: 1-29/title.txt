Balancing cooperation and risk in intrusion detection