Know Your Enemy: Compromising Adversaries in Protocol Analysis