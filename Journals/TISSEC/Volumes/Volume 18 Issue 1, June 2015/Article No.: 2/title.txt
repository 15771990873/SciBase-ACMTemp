Misbehavior in Bitcoin: A Study of Double-Spending and Accountability