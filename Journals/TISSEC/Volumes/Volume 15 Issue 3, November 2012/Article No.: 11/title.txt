Effectiveness and detection of denial-of-service attacks in tor