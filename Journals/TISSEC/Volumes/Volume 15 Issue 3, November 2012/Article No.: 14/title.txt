Probabilistic analysis of onion routing in a black-box model