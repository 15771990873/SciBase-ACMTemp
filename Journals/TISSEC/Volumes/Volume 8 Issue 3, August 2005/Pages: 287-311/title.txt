The concept of layered proving trees and its application to the automation of security protocol verification