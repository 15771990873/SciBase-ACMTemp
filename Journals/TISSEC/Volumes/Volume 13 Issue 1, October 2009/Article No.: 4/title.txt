Control-flow integrity principles, implementations, and applications