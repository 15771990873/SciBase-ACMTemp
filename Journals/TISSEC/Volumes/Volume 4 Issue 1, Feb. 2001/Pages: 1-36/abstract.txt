A real-time knowledge-based network intrusion-detection model for a link-state routing protocol is presented for theOSPFprotocol. This model includes three layers: adata process layerto parse packets and dispatch data; andevent abstractorto abstract predefined real-time events for the link-state routing protocol; and anextended timed finite state machineto express the real-time behavior of the protocol engine and to detect intrusions by pattern matching. The timed FSM, called theJiNao Finite State Machine(JFSM) is extended from the conventional FSM with timed states, multiple timers, and time constraints on state transitions. The JFSM is implemented as a generator that can create and FSM by constructing the configuration file only. The results show that this approach is very effective for detecting real-time intrusions. Our approach can be extended for use in other network protocol intrusion-detection systems, especially for those with known attacks.