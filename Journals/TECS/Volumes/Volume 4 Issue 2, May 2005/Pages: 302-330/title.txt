Converging CSP specifications and C++ programming via selective formalism