Compiler-Supported Thread Management for Multithreaded Network Processors