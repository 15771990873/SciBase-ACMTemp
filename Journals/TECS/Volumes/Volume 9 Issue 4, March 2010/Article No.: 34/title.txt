A polynomial algorithm for partitioning problems