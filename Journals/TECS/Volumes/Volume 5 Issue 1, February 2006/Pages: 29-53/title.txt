A formal method for hardware IP design and integration under I/O and timing constraints