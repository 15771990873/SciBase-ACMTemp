Energy savings and speedups from partitioning critical software loops to hardware in embedded systems