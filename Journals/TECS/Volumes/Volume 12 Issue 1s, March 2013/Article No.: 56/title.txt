Moths: Mobile threads for on-chip networks