Efficient hardware-based nonintrusive dynamic application profiling