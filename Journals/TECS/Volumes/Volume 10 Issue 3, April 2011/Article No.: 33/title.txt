A framework for defending embedded systems against software attacks