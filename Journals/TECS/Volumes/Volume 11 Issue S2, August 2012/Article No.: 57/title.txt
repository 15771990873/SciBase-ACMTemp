A Unified Methodology for Scheduling in Distributed Cyber-Physical Systems