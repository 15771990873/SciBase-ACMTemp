Energy-efficient and high-performance software architecture for storage class memory