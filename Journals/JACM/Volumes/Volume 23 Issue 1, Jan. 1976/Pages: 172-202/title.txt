A Fast and Usually Linear Algorithm for Global Flow Analysis