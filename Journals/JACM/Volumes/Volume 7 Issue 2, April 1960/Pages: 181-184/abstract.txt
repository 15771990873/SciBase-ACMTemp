Filon's method of numerical integration was developed to deal with integrals of the formI= ∫BAƒ(x) cospx dx(1) (Filon, 1928; Tranter, 1951). This method, most useful whenpis large, is a modified Simpson's rule using an interval no larger than is required to integrate ∫BAƒ(x)dxalone to the desired accuracy. The derivation proceeds as follows: The range of integration is divided into panels of width 2h, and a second-order curve is fitted to the middle and end ordinates of one panel. After twice integrating by parts over the width of the panel and summing over all the panels, the result isI=h{&agr;}[ƒ(B) sinpB- ƒ(A) sinpA] +&bgr;Ce+&ggr;Co}, (2) wherehis the interval,Ceis the sum of all the even ordinates of ƒ(x) cospxless half the end ordinates,Cois the sum of all the odd ordinates of ƒ(x) cospxless half the end ordinates,Cois the sum of all the odd ordinates of ƒ(x) cospx, and&thgr;=hp&thgr;3&agr;=&thgr;2+&thgr;sin&thgr;cos&thgr;- 2 sin2&thgr;&thgr;3&bgr;= 2[&thgr;(1 + cos2) - 2 sin&thgr;cos&thgr;]&thgr;3&ggr;= 4[sin&thgr;-&thgr;cos&thgr;]. (3) In the limit aspapproaches zero, (2) reduces to Simpson's rule.The present modification was developed to evaluate functions of the formF(T) = ∫T0ƒ(x) cospx dxusing a larger interval for a permissible error than is possible with Filon's formula.A fifth-order instead of a second-order curve may be fitted to the middle and end points of a panel. Substituting the first five terms of a Stirling approximation into (1), integrating over the width of the panel by parts five times, and summing over all the panels, we obtainI= ∫BAƒ(x) cospx dx=h{S[ƒ(B) sinpB- ƒ(A) sinpA] +hP[ƒ′(B) cospB- ƒ′(A) cospA] +RCce+hQ C′se+NCco+hM C′so(4) where primes denote differentiation with respect to the argument,Cco= sum of odd ordinates of ƒ(x) cospx;C′so= sum of odd ordinates of ƒ′(x) sinpx;Cce= sum of even ordinates of ƒ(x) cospx, less half the end ordinates;C′se= sum of even ordinates of ƒ′(x) sinpx, less half the end ordinates; and&thgr;=hp&thgr;6M= 16&thgr;(15 -&thgr;2) cos&thgr;+ 48(2&thgr;2- 5) sin&thgr;&thgr;6N= 16&thgr;(3 -&thgr;2) sin&thgr;- 48&thgr;2cos&thgr;&thgr;6P= 2&thgr;(&thgr;2- 24) sin&thgr;cos&thgr;+ 15(&thgr;2- 4) cos2&thgr;+&thgr;4- 27&thgr;2+ 60&thgr;6Q= 2[&thgr;(12 - 5&thgr;2) + 15(thgr;2- 4) sin&thgr;cos&thgr;+ 2&thgr;(24 -&thgr;2) cos2&thgr;]&thgr;2R= 2[&thgr;(156 - 7&thgr;2) sin&thgr;cos&thgr;+ 3(60 - 17&thgr;2) cos2&thgr;- 15(12 - 5&thgr;2)]&thgr;6S=&thgr;(&thgr;4+ 8&thgr;2- 24) +&thgr;(7&thgr;2- 156) cos2&thgr;+ 3(60 - 17&thgr;2) sin&thgr;cos&thgr;. (5)For&thgr;less than about 0.9, it is better to expand equations (5) in powers of&thgr;:M= -16/105&thgr;+ 8/945&thgr;3- 2/10395&thgr;5+ 1/405405&thgr;7- 1/48648600&thgr;9N= 16/15 - 8/105&thgr;2+ 2/945&thgr;4- 1/31185&thgr;6+ 1/3243240&thgr;8P= -1/15 + 2/105&thgr;2- 1/315&thgr;4+ 2/7425&thgr;6- 62/4729725&thgr;8Q= -8/105&thgr;+ 16/945&thgr;3- 104/51975&thgr;5+ 256/2027025&thgr;7- 16/3274425&thgr;9R= 14/15 - 16/105&thgr;2+ 22/945&thgr;4- 608/311850&thgr;6+ 268/2837835&thgr;8S= 19/105&thgr;- 2/63&thgr;3+ 1/275&thgr;5- 2/8775&thgr;7+ 34/3869775&thgr;9.(6) For sinpxinstead of cospxin the integrand, the result is ∫BAƒ(x) sinpx dx=h{S[ƒ(A) cospA- ƒ (B) cospB] +hP[ƒ′(B) sinpB- ƒ′