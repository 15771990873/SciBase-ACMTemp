A unified approach to approximating resource allocation and scheduling