Optimal design and use of retry in fault-tolerant computer systems