Equivalence and optimization of relational transactions