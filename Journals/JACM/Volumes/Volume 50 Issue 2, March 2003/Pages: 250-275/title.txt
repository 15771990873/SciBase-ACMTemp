A foundation for designing deadlock-free routing algorithms in wormhole networks