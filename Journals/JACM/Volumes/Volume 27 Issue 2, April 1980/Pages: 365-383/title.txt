A Syntactic Theory of Message Passing