Market equilibrium under separable, piecewise-linear, concave utilities