The reduction of perturbed Markov generators: an algorithm exposing the role of transient states