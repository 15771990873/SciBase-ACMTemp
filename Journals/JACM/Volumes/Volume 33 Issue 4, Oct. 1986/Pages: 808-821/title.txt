Polynomial-time algorithm for the orbit problem