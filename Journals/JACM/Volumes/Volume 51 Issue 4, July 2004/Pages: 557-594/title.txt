The random oracle methodology, revisited