The Generation of Optimal Code for Stack Machines