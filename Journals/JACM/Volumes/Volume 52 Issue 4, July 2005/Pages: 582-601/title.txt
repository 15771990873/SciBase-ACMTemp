Source routing and scheduling in packet networks