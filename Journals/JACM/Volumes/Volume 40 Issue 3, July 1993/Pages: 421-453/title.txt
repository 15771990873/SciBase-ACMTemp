Random walks on weighted graphs and applications to on-line algorithms