Aggregating inconsistent information: Ranking and clustering