Nearly optimal algorithms and bounds for multilayer channel routing