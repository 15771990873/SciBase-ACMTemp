Improved bounds and new techniques for Davenport--Schinzel sequences and their generalizations