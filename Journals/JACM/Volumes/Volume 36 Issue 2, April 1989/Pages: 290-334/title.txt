Optimum combinations of sorting and merging