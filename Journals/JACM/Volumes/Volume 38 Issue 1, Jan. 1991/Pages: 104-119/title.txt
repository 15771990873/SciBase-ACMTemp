Optimal sample cost residues for differential database batch query problems