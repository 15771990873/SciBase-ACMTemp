A theory of goal-oriented communication