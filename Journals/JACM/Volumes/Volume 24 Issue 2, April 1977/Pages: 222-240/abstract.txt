This paper presents a queueing model of a multiprogrammed computer system with virtual memory. Two system organizations are considered: (i) all the processes present in the system share primary storage; (ii) processes which have generated a file request (slow I/O) lose their memory space until the I/O is completed. Our model assumes balanced memory allocation among processes, and accounts for the memory sharing effect through the use of lifetime functions. The model explicitly takes into account the fact that, if a written-onto page is to be replaced at the moment of a page fault, it first has to be saved in the secondary memory. An approximate closed form solution is obtained by using an equivalence and decomposition approach. A procedure for evaluating the accuracy of the approximation is presented. The numerical examples illustrate the influence of the system and program behavior parameters taken into account in our model.