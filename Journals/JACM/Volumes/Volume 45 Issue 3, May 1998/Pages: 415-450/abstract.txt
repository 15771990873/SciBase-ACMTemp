We examine a class ofcollective coin-flipping gamesthat arises from randomized distributed algorithms with halting failures. In these games, a sequence oflocal coin flipsis generated, which must be combined to form a singleglobal coin flip. An adversary monitors the game and may attempt to bias its outcome by hiding the result of up totlocal coin flips. We show that to guarantee at most constant bias, &ohgr;(t2) local coins are needed, even if (a) the local coins can have arbitrary distributions and ranges, (b) the adversary is required to decide immediately wheter to hide or reveal each local coin, and (c) the game can detect which local coins have been hidden. If the   adversary is permitted to control the outcome of the coin except for cases whose probability is polynomial int, &ohgr;(t2/log2t) local coins are needed. Combining this fact with an extended version of the well-known Fischer-Lynch-Paterson impossibility proof of deterministic consensus, we show that given an adaptive adversary, anyt-resilient asynchronous consensus protocol requires &ohgr;(t2/log2t) local coin flips in any model that can be simulated deterministically using atomic registers. This gives the first nontrivial lower bound on the total work required by wait-free consensus and is tight to within   logarithmic factors.