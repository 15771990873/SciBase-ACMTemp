Optimal Code Generation for Expression Trees