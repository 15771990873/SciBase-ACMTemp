A theory of using history for equational systems with applications