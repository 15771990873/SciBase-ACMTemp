Mathematical Techniques for Efficient Record Segmentation in Large Shared Databases