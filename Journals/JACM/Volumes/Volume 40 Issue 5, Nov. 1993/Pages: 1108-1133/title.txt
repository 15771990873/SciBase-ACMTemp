Complexity and algorithms for reasoning about time: a graph-theoretic approach