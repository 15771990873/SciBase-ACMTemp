On-line routing of virtual circuits with applications to load balancing and machine scheduling