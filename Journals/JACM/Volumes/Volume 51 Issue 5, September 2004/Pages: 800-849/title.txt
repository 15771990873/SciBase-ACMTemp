A unified theory of shared memory consistency