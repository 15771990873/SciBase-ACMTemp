Efficient routing in optical networks