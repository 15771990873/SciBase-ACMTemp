Optimization of Memory Hierarchies in Multiprogrammed Systems