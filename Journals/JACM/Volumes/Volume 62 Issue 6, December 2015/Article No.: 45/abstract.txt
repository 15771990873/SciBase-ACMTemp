In an attribute-based encryption (ABE) scheme, a ciphertext is associated with an &ell;-bitpublic indexind and a messagem, and a secret key is associated with a Boolean predicateP. The secret key allows decrypting the ciphertext and learningmif and only ifP(ind) = 1. Moreover, the scheme should be secure against collusions of users, namely, given secret keys for polynomially many predicates, an adversary learns nothing about the message if none of the secret keys can individually decrypt the ciphertext.We present attribute-based encryption schemes for circuits of any arbitrary polynomial size, where the public parameters and the ciphertext grow linearly with the depth of the circuit. Our construction is secure under the standard learning with errors (LWE) assumption. Previous constructions of attribute-based encryption were for Boolean formulas, captured by the complexity classNC1.In the course of our construction, we present a new framework for constructing ABE schemes. As a by-product of our framework, we obtain ABE schemes for polynomial-size branching programs, corresponding to the complexity classLOGSPACE, under quantitatively better assumptions.