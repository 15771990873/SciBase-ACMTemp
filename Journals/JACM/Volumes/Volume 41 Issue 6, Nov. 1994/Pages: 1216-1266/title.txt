Modular stratification and magic sets for Datalog programs with negation