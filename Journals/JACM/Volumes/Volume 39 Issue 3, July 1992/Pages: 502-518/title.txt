An efficient algorithm for a task allocation problem