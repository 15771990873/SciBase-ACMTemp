A little knowledge goes a long way: knowledge-based derivations and correctness proofs for a family of protocols