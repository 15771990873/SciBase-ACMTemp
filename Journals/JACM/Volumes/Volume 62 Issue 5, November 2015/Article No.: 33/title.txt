LSH-Preserving Functions and Their Applications