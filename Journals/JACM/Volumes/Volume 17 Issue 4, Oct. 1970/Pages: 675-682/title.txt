Necessary and Sufficient Conditions for Dynamic Programming of Combinatorial Type