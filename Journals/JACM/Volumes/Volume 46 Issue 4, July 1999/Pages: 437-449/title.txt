Efficient algorithms for inverting evolution