Query evaluation via tree-decompositions