Circumscription with homomorphisms: solving the equality and counterexample problems