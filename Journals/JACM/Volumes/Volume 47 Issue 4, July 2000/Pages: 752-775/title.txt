Balanced sequences and optimal routing