Divide-and-conquer approximation algorithms via spreading metrics