Graph partitioning using single commodity flows