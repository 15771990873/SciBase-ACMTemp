We study the weighted version of the classic online paging problem where there is a weight (cost) for fetching each page into the cache. We design a randomizedO(logk)-competitive online algorithm for this problem, wherekis the cache size. This is the first randomizedo(k)-competitive algorithm and its competitive ratio matches the known lower bound for the problem, up to constant factors. More generally, we design anO(log(k/(k−h+ 1)))-competitive online algorithm for the version of the problem where the online algorithm has cache sizekand it is compared to an optimal offline solution with cache sizeh≤k.Our solution is based on a two-step approach. We first obtain anO(logk)-competitive fractional algorithm based on an online primal-dual approach. Next, we obtain a randomized algorithm by rounding in an online manner the fractional solution to a probability distribution on the possible cache states. We also give an online primal-dual randomizedO(logN)-competitive algorithm for the Metrical Task System problem (MTS) on a weighted star metric onNleaves.