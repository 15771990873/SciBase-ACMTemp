From Almost Optimal Algorithms to Logics for Complexity Classes via Listings and a Halting Problem