We present a near-optimal reduction from approximately counting the cardinality of a discrete set to approximately sampling elements of the set. An important application of our work is to approximating the partition functionZof a discrete system, such as the Ising model, matchings or colorings of a graph. The typical approach to estimating the partition functionZ(β&ast;) at some desired inverse temperature β&ast;is to define a sequence, which we call acooling schedule, β0&equals; 0 < β1< … < β&ell;&equals; β&ast;whereZ(0)is trivial to compute and the ratiosZ(βi+1)/Z(βi) are easy to estimate by sampling from the distribution corresponding toZ(βi). Previous approaches required a cooling schedule of lengthO&ast;(lnA) whereA&equals;Z(0), thereby ensuring that each ratioZ(βi+1)/Z(βi) is bounded. We present a cooling schedule of length &ell; &equals;O&ast;(&sqrt; lnA).For well-studied problems such as estimating the partition function of the Ising model, or approximating the number of colorings or matchings of a graph, our cooling schedule is of lengthO&ast;(&sqrt;n), which implies an overall savings ofO&ast;(n) in the running time of the approximate counting algorithm (since roughly &ell; samples are needed to estimate each ratio).A similar improvement in the length of the cooling schedule was recently obtained by Lovász and Vempala in the context of estimating the volume of convex bodies. While our reduction is inspired by theirs, the discrete analogue of their result turns out to be significantly more difficult. Whereas a fixed schedule suffices in their setting, we prove that in the discrete setting we need an adaptive schedule, that is, the schedule depends onZ. More precisely, we prove any nonadaptive cooling schedule has length at leastO&ast;(lnA), and we present an algorithm to find an adaptive schedule of lengthO&ast;(&sqrt; lnA).