Code-Smell Detection as a Bilevel Problem