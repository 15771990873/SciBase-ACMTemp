Term rewriting with traversal functions