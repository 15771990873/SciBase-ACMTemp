Effective typestate verification in the presence of aliasing