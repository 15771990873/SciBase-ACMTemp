Path- and index-sensitive string analysis based on monadic second-order logic