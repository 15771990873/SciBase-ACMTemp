Automatic high-quality reengineering of database programs by abstraction, transformation and reimplementation