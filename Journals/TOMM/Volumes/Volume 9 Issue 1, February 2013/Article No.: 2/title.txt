Image retrieval with query-adaptive hashing