Hierarchical video patching with optimal server bandwidth