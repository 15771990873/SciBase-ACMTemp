Scalable on-demand media streaming for heterogeneous clients