Optimal river routing with crosstalk constraints