A new viewpoint on code generation for directed acyclic graphs