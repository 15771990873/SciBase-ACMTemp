Partitioning sequential programs for CAD using a three-step approach