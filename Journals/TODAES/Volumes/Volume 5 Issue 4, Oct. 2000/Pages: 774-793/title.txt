Constraint analysis for code generation: basic techniques and applications in FACTS