A fast algorithm for context-aware buffer insertion