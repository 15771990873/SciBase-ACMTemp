Optimizing designs containing black boxes