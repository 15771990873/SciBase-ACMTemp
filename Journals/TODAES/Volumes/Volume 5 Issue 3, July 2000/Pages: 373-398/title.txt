Retiming-based factorization for sequential logic optimization