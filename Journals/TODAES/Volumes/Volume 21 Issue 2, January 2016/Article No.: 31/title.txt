ECDSA Passive Attacks, Leakage Sources, and Common Design Mistakes