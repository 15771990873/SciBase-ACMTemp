Energy-Efficient Progressive Remote Update for Flash-Based Firmware of Networked Embedded Systems