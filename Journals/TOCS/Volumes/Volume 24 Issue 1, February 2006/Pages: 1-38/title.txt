Cryptography as an operating system service: A case study