Shielding Applications from an Untrusted Cloud with Haven