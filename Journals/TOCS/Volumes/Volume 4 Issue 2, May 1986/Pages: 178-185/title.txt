A tree-structured mean value analysis algorithm