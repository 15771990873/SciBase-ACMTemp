Improving peer-to-peer performance through server-side scheduling