This article studies undefined behavior arising in systems programming languages such as C/C&plus;&plus;. Undefined behavior bugs lead to unpredictable and subtle systems behavior, and their effects can be further amplified by compiler optimizations. Undefined behavior bugs are present in many systems, including the Linux kernel and the Postgres database. The consequences range from incorrect functionality to missing security checks. This article proposes a formal and practical approach that finds undefined behavior bugs by finding “unstable code” in terms of optimizations that leverage undefined behavior. Using this approach, we introduce a new static checker called Stackthat precisely identifies undefined behavior bugs. Applying Stackto widely used systems has uncovered 161 new bugs that have been confirmed and fixed by developers.