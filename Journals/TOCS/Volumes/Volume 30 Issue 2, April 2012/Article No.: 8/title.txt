A Hierarchical Thread Scheduler and Register File for Energy-Efficient Throughput Processors