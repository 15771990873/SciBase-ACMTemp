Comprehensive formal verification of an OS microkernel