Throughput optimal total order broadcast for cluster environments