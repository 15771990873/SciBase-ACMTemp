Ace: a language for parallel programming with customizable protocols