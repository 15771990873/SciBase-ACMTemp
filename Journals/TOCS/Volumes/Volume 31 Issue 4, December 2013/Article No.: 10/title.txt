CORFU: A distributed shared log