Fast and Portable Locking for Multicore Architectures