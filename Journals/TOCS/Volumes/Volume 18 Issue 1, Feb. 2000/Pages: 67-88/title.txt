Smart packets: applying active networks to network management