An embedded domain-specific language for type-safe server-side web scripting