Atomicity and isolation for transactional processes