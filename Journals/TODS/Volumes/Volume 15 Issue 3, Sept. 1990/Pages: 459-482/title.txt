Necessary and sufficient conditions to linearize doubly recursive programs in logic databases