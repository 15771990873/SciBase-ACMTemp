The theory of joins in relational databases