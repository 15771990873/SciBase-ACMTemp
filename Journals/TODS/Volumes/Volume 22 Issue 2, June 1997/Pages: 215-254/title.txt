Applying formal methods to semantic-based decomposition of transactions