Formal aspects of concurrency control in long-duration transaction systems using the NT/PV model