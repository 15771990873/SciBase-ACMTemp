Incremental maintenance of shortest distance and transitive closure in first-order logic and SQL