Rule-based optimization and query processing in an extensible geometric database system