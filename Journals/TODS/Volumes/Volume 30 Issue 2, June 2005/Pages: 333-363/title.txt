Tight upper bounds on the number of candidate patterns