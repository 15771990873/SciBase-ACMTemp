Optimal algorithms for evaluating rank joins in database systems