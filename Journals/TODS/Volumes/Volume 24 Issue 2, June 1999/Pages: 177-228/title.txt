Optimization of queries with user-defined predicates