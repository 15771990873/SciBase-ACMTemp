Data structures for efficient broker implementation