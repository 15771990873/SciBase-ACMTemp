Database concurrency control using data flow graphs