Rewriting queries with arbitrary aggregation functions using views