Compression, information theory, and grammars: a unified approach