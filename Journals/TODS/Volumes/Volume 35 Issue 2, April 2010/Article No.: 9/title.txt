Optimal matching between spatial datasets under capacity constraints