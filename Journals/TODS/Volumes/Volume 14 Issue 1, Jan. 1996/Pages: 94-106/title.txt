An extension of Ukkonen's enhanced dynamic programming ASM algorithm