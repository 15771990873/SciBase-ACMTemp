A rule-based language with functions and sets