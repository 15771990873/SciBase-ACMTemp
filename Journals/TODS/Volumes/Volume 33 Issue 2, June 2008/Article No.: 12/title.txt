On computing temporal aggregates with range predicates