SQL query optimization through nested relational algebra