Theory of keyblock-based image retrieval