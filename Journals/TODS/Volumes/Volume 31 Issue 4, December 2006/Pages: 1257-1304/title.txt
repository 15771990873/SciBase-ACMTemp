Adaptive rank-aware query optimization in relational databases