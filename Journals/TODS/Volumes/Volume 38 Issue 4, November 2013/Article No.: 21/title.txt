High-performance complex event processing over hierarchical data