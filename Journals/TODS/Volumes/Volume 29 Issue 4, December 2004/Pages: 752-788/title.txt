Processing XML streams with deterministic automata and stream indexes