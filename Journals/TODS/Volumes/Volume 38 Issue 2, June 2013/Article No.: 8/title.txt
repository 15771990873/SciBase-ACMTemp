Analysis and optimization for boolean expression indexing