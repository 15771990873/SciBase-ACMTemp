An erasure-resilient encoding system for flexible reading and writing in storage networks