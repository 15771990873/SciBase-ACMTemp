M-AID: An adaptive middleware built upon anomaly detectors for intrusion detection and rational response