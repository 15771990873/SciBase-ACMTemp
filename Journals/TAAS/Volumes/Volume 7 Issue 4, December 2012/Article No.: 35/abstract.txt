This article presents an ant-based approach that enhances the flexibility, robustness and load balancing characteristics of structured P2P systems. Most notably, the approach allows peer indexes and resource keys to be defined on different and independent spaces, so that it overcomes the main limitation of standard structured P2P systems, that is, the need to assign each key to a peer having a specified index. This helps to improve load balancing, especially when the popularity distribution of resource keys is nonuniform, and enables the efficient execution of complex and range queries, which are essential in important types of distributed systems, for example, in Grids and Clouds. Beyond describing the general approach, this article focuses on the specific case of Self-CAN, a self-organizing P2P system that, while relying on the multidimensional structured organization of peers provided by CAN, exploits the operations of ant-based mobile agents to sort the resource keys and distribute them to peers. This system is particularly useful for the management and discovery of the resources that can be conveniently characterized by the values of several independent attributes.