Improved algorithms for optimal embeddings