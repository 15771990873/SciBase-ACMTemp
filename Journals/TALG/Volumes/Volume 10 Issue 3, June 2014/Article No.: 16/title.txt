Fully Functional Static and Dynamic Succinct Trees