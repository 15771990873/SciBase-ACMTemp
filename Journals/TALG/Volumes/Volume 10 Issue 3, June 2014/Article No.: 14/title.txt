Faster Algorithms for Semi-Matching Problems