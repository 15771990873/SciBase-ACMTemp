An improved algorithm for CIOQ switches