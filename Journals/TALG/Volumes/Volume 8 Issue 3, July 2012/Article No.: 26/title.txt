Polynomial-time algorithms for minimum energy scheduling