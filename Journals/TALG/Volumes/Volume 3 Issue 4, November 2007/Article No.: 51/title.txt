Oblivious routing on node-capacitated and directed graphs