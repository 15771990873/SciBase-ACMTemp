We present a linear-time algorithm to compute a decomposition scheme for graphsGthat have a setX⊆V(G), called atreewidth-modulator, such that the treewidth ofG−Xis bounded by a constant. Our decomposition, called aprotrusion decomposition, is the cornerstone in obtaining the following two main results. Our first result is that any parameterized graph problem (with parameterk) that has afinite integer indexand such that Yes-instances have a treewidth-modulator of sizeO(k) admits a linear kernel on the class ofH-topological-minor-free graphs, for any fixed graphH. This result partially extends previous meta-theorems on the existence of linear kernels on graphs of bounded genus andH-minor-free graphs. LetFbe a fixed finite family of graphs containing at least one planar graph. Given ann-vertex graphGand a non-negative integerk, Planar-F-Deletionasks whetherGhas a setX⊆V(G) such that &verbar;X&verbar; &les;kandG−XisH-minor-free for everyH&epsi;F. As our second application, we present the firstsingle-exponentialalgorithm to solve Planar-F-Deletion. Namely, our algorithm runs in time 2O(k)·n2, which is asymptotically optimal with respect tok. So far, single-exponential algorithms were only known for special cases of the familyF.