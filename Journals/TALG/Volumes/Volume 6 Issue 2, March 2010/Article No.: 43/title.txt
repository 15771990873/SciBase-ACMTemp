Periodicity testing with sublinear samples and space