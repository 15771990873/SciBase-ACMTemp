Routing and scheduling in multihop wireless networks with time-varying channels