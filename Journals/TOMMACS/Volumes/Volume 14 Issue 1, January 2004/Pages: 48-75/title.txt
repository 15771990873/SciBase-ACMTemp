Modeling train movements through complex rail networks