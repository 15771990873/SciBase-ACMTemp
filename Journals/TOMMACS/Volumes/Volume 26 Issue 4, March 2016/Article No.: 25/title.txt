Efficient Flattening Algorithm for Hierarchical and Dynamic Structure Discrete Event Models