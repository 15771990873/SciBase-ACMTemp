A state event detection algorithm for numerically simulating hybrid systems with model singularities