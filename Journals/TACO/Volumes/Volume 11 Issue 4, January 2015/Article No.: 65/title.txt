Efficient Correction of Anomalies in Snapshot Isolation Transactions