MAPS: Optimizing Massively Parallel Applications Using Device-Level Memory Abstraction