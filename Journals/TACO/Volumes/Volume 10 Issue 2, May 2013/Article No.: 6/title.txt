Near-Optimal Microprocessor and Accelerators Codesign with Latency and Throughput Constraints