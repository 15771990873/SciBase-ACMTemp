CERE: LLVM-Based Codelet Extractor and REplayer for Piecewise Benchmarking and Optimization