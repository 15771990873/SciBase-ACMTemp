Optimal trace scheduling using enumeration