Topology-Aware and Dependence-Aware Scheduling and Memory Allocation for Task-Parallel Languages