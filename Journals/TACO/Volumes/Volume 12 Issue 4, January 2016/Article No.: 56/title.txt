Rethinking Memory Permissions for Protection Against Cross-Layer Attacks