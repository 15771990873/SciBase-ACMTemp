Citadel: Efficiently Protecting Stacked Memory from TSV and Large Granularity Failures