Efficient and flexible architectural support for dynamic monitoring