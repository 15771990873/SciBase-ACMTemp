Using in-flight chains to build a scalable cache coherence protocol