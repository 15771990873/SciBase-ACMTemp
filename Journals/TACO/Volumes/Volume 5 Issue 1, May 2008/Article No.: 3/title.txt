Compiler and hardware support for reducing the synchronization of speculative threads