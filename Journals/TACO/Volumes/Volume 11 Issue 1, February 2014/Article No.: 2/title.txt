Integrating profile-driven parallelism detection and machine-learning-based mapping