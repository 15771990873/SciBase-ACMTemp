Eliminating voltage emergencies via software-guided code transformations