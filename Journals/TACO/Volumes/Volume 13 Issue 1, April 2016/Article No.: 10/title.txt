Understanding and Mitigating Covert Channels Through Branch Predictors