On scalable attack detection in the network