An efficient packet scheduling algorithm with deadline guarantees for input-queued switches