A hybrid hardware architecture for high-speed IP lookups and fast route updates