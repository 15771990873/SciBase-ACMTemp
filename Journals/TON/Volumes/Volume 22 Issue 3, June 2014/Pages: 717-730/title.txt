Optimal distributed P2P streaming under node degree bounds