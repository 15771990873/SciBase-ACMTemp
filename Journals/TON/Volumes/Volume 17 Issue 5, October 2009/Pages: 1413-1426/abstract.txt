The paper considers a TCP/IP-style network with flow control at end-systems based on congestion feedback and routing decisions at network nodes on a per-destination basis. The main generalization with respect to standard IP is to allow routers to split their traffic in a controlled way between the outgoing links. We formulate global optimization criteria, combining those used in the congestion control and traffic engineering, and propose decentralized controllers at sources and routers to reach these optimal points, based on congestion price feedback. We first consider adapting the traffic splits at routers to follow the negative price gradient; we prove this is globally stabilizing when combined with primal congestion control, but can exhibit oscillations in the case of dual congestion control. We then propose an alternative anticipatory control of routing, proving its stability for the case of dual congestion control. We present a concrete implementation of such algorithms, based on queueing delay as congestion price. We use TCP-FAST for congestion control and develop a multipath variant of the distance vector routing protocol RIP. We demonstrate through ns2-simulations the collective behavior of the system, in particular that it reaches the desired equilibrium points.