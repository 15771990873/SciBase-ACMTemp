CR switch: a load-balanced switch with contention and reservation