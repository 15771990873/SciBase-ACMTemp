A polynomial algorithm for gateway generation from formal specifications