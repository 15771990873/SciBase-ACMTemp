A credit manager for traffic regulation in high-speed networks: a queueing analysis