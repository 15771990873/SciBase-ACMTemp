Supporting stored video: reducing rate variability and end-to-end resource requirements through optimal smoothing