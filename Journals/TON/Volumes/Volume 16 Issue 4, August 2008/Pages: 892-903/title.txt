Optimal routing and data aggregation for maximizing lifetime of wireless sensor networks