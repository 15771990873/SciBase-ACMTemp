Achieving 100% throughput in reconfigurable optical networks