Coordinated multihop scheduling: a framework for end-to-end services