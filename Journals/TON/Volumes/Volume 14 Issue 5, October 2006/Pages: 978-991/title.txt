Incentive and service differentiation in P2P networks: a game theoretic approach