On optimal scheduling algorithms for small generalized switches