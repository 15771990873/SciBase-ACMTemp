Weak state routing for large-scale dynamic networks