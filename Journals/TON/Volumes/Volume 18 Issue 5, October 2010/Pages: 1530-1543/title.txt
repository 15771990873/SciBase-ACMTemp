Cost-effective multiperiod spraying for routing in delay-tolerant networks