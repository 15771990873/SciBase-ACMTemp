Increasing the portability and re-usability of protocol code