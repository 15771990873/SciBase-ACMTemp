This paper proposes a new dynamic bandwidth allocation system for Ethernet Passive Optical Networks (EPONs), subject to requirements of fairness, efficiency, and cost. An Optical Line Terminal (OLT)-centric bandwidth allocation model is proposed which employs a credit pooling technique combined with a weighted-share policy to partition the upstream bandwidth among different classes of service, and to prevent Optical Network Units (ONUs) from monopolizing the bandwidth. The OLT-centric model allows global optimization of network resources, a characteristic which is not found in many earlier proposals. Supported by the new bandwidth allocation, the paper proposes a joint-ONU interval-based packet scheduling algorithm, referred to herein as COPS (Class-of-service Oriented Packet Scheduling), that meets the requirements set out above. We compare COPS with another well-known scheduling algorithm which employed a standard priority-based bandwidth sharing. We show that COPS is superior in terms of network utilization and maximum packet delay, with the consequence of an increase in average packet delay for the premium traffic. This drawback is overcome by combining COPS with a rate-based optimization scheme.