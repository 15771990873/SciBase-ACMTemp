Core-stateless fair queueing: a scalable architecture to approximate fair bandwidth allocations in high-speed networks