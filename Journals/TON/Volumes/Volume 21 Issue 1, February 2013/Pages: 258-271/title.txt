Scheduling in a random environment: stability and asymptotic optimality