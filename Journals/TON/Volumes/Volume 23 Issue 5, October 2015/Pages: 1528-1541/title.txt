A message-passing algorithm for wireless network scheduling