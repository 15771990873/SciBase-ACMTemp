Rating network paths for locality-aware overlay construction and routing