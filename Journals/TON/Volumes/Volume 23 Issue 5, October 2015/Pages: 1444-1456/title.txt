Stable distributed P2P protocols based on random peer sampling