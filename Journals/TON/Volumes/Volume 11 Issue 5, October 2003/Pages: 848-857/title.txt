Achieving stability in networks of input-queued switches