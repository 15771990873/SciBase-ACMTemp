Approximating fluid schedules in crossbar packet-switches and Banyan networks