A two-time-scale design for edge-based detection and rectification of uncooperative flows