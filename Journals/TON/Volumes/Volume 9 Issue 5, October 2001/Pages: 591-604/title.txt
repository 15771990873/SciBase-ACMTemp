Credit-based fair queueing (CBFQ): a simple service-scheduling algorithm for packet-switched networks