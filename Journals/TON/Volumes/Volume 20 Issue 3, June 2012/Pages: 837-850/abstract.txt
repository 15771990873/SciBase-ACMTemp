Cognitive radio (CR) allows unlicensed users to access the licensed spectrum opportunistically (i.e., when the spectrum is left unused by the licensed users) to enhance the spectrum utilization efficiency. In this paper, the problem of allocating resources (channels and transmission power) in multihop CR networks is modeled as a multicommodity flow problem with the dynamic link capacity resulting from dynamic resource allocation, which is in sharp contrast with existing flow-control approaches that assume fixed link capacity. Based on queue-balancing network flow control that is ideally suited for handling dynamically changing spectrum availability in CR networks, we propose a distributed scheme (installed and operational in each node) for optimal resource allocation without exchanging spectrum dynamics information between remote nodes. Considering the power masks, each node makes resource-allocation decisions based on current or past local information from neighboring nodes to satisfy the throughput requirement of each flow. Parameters of these proposed schemes are configured to maintain the network stability. The performance of the proposed scheme for both asynchronous and synchronous scenarios is analyzed comparatively. Both cases of sufficient and insufficient network capacity are considered.