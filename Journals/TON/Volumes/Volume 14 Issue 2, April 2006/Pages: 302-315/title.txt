The impact of imperfect scheduling on cross-layer congestion control in wireless networks