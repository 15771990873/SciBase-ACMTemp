We develop on-line routing and wavelength assignment (RWA) algorithms for WDM bidirectional ring and torus networks withNnodes. The algorithms dynamically support all k-allowable traffic matrices, where k denotes an arbitrary integer vector [k1,k2,...,kN], and nodei, 1 ≤i≤N, can transmit at mostkiwavelengths and receive at mostkiwavelengths. Both algorithms support the changing traffic in a rearrangeably nonblocking fashion. Our first algorithm, for a bidirectional ring, uses ⌈(Σi=1Nki)/3⌉ wavelengths in each fiber and requires at most three lightpath rearrangements per new session request regardless of the number of nodesNand the amount of traffic k. When all theki's are equal tok, the algorithm uses ⌈kN/3⌉ wavelengths, which is known to be the minimum for any off-line rearrangeably nonblocking algorithm. Our second algorithm, for a torus topology, is an extension of a known off-line algorithm for the special case with all theki's equal tok. For anR × Ctorus network withR ≥ Cnodes, our on-line algorithm uses ⌈kR/2⌉ wavelengths in each fiber, which is the same as in the off-line algorithm, and is at most two times a lower bound obtained by assuming full wavelength conversion at all nodes. In addition, the on-line algorithm requires at mostC- 1 lightpath rearrangements per new session request regardless of the amount of traffick. Finally, each RWA update requires solving a bipartite matching problem whose time complexity is onlyO(R), which is much smaller than the time complexityO(kCR2)of the bipartite matching problem for an off-line algorithm.