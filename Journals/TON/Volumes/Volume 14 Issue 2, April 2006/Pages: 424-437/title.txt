Network protocol system monitoring: a formal approach with passive testing