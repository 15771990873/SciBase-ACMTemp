A unified MAC layer framework for ad-hoc networks with smart antennas