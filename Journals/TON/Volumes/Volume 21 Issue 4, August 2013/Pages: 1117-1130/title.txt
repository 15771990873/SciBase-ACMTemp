Utility optimal scheduling in energy-harvesting networks