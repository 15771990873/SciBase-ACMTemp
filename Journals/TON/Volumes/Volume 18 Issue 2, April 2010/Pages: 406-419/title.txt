The optimality of two prices: maximizing revenue in a stochastic communication system