Network decomposition: theory and practice