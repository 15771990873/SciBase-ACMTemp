A unifying model and analysis of P2P VoD replication and scheduling