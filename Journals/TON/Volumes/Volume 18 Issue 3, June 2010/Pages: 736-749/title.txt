Integration of false data detection with data aggregation and confidential transmission in wireless sensor networks