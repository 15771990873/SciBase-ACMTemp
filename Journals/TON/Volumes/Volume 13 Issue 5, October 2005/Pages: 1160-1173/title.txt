An algebraic theory of dynamic network routing