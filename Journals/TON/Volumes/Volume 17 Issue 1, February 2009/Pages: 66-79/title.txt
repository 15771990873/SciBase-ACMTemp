Detecting network-wide and router-specific misconfigurations through data mining