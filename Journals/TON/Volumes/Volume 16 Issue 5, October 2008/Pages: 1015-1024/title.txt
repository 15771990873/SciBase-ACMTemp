Centralized and distributed algorithms for routing and weighted max-min fair bandwidth allocation