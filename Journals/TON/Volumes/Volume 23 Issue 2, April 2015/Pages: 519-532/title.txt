Capacity achieving distributed scheduling with finite buffers