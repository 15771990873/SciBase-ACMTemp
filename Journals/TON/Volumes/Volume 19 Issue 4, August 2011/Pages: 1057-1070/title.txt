Throughput-optimal opportunistic scheduling in the presence of flow-level dynamics