Modeling complex packet filters with finite state automata