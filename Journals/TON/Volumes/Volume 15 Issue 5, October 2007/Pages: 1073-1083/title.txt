A unified framework for max-min and min-max fairness with applications