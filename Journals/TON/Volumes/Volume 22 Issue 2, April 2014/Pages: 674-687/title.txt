Nonconcave utilitymaximization in locally coupled systems, with applications to wireless and wireline networks