Optimizing the system of virtual paths