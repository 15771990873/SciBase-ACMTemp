Optimal source-based filtering of malicious traffic