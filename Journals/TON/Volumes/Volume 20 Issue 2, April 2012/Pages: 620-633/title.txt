On the impact of TCP and per-flow scheduling on internet performance