A mathematical framework for analyzing adaptive incentive protocols in P2P networks