A domain decomposition algorithm for constraint satisfaction