Computing the nxm shortest path efficiently