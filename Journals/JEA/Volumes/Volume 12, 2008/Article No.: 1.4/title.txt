Efficient IP table lookup via adaptive stratified trees with selective reconstructions