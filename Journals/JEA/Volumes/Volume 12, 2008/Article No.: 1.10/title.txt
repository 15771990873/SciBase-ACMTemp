A graph approach to the threshold all-against-all substring matching problem