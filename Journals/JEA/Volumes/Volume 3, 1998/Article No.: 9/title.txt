Implementation of dynamic trees with in-subtree operations