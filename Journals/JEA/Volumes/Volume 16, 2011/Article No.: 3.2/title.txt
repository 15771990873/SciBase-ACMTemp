Theory and practice of monotone minimal perfect hashing