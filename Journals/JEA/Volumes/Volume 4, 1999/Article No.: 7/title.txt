Implementing weighted b-matching algorithms: towards a flexible software design