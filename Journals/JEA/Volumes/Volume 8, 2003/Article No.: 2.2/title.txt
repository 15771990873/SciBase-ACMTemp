A blocked all-pairs shortest-paths algorithm