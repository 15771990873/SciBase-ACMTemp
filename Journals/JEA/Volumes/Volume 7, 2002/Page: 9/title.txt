Efficient sorting using registers and caches