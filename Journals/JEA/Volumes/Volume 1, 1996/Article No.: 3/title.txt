Practical parallel algorithms for personalized communication and integer sorting