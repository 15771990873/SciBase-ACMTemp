Optimal selection and sorting via dynamic programming