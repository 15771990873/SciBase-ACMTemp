Dealing with random and selective attacks in wireless sensor systems