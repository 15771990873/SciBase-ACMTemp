Theory and Algorithm of Estimating Energy Consumption Breakdowns using ON/OFF State Sensing