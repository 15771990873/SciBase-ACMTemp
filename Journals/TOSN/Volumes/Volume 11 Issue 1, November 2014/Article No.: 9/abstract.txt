Understanding the optimal usage of fluctuating renewable energy in wireless sensor networks (WSNs) is complex. Lexicographic max-min (LM) rate allocation is a good solution but is nontrivial for multihop WSNs, as both fairness and sensing rates have to be optimized through the exploration of all possible forwarding routes in the network. All current optimal approaches to this problem are centralized and offline, suffering from low scalability and large computational complexityâ€”typically solving O(N2) linear programming problems forN-node WSNs. This article presents the first optimal distributed solution to this problem with much lower complexity. We apply it to solar-powered wireless sensor networks (SP-WSNs) to achieve both LM optimality and sustainable operation. Based on realistic models of both time-varying solar power and photovoltaic-battery hardware, we propose an optimization framework that integrates a local power management algorithm with a global distributed LM rate allocation scheme. The optimality, convergence, and efficiency of our approaches are formally proven. We also evaluate our algorithms via experiments on both solar-powered MICAz motes and extensive simulations using real solar energy data and practical power parameter settings. The results verify our theoretical analysis and demonstrate how our approach outperforms both the state-of-the-art centralized optimal and distributed heuristic solutions.