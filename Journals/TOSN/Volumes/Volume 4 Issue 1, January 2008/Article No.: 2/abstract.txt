As sensor networks operate over long periods of deployment in difficult to reach places, their requirements may change or new code may need to be uploaded to them. The current state-of-the-art protocols (Deluge and MNP) for network reprogramming perform the code dissemination in a multihop manner using a three-way handshake where metadata is exchanged prior to code exchange to suppress redundant transmissions. The code image is also pipelined through the network at the granularity of pages. In this article we propose a protocol called Freshet for optimizing the energy for code upload and speeding up the dissemination if multiple sources of code are available. The energy optimization is achieved by equipping each node with limited nonlocal topology information which it uses to determine the time when it can go to sleep since code is not being distributed in its vicinity. The protocol to handle multiple sources provides a loose coupling of nodes to a source and disseminates code in waves each originating at a source with a mechanism to handle collisions when the waves meet. The protocol's performance with respect to reliability, delay, and energy consumed is demonstrated through analysis, simulation, and implementation on the Berkeley mote platform.