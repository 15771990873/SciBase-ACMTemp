Energy-efficient on-demand reprogramming of large-scale sensor networks