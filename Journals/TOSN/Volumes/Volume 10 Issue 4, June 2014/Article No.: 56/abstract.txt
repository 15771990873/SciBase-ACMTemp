We consider the problem of maximizing the lifetime of a query-based wireless sensor network in which all of the sensor nodes are both producers and consumers of network resources. Of particular concern is the problem of selecting a common transmission range for all of the sensor nodes, the resource replication level (or time-to-live counter), and the active/sleep schedule of nodes while satisfying connectivity and quality-of-service constraints. To this end, we first formulate a general, mixed-integer programming model that selects the optimal operating parameters in each period of a finite planning horizon. Subsequently, we examine in detail specific connectivity and quality-of-service constraints that can be considered within this framework. Due to the complexity of the model, we formulate an alternative linearized version that can be solved more efficiently. Additionally, we devise a simple algorithm to solve a special case of the problem when alive nodes are always active. Computational results indicate that the maximum attainable lifetime can be significantly improved by adjusting the key operating parameters as sensor nodes fail over time due to energy depletion.