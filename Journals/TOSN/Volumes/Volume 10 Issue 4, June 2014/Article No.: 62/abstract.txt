While it is essential to exploit in-network processing in wireless sensor networks in order to save bandwidth and energy, we are constrained by the limited storage available in off-the-shelf sensor devices. NAND flash memory has great potential for extending storage capacity for sensor applications. Since each sensor platform is typically equipped with limited main memory and sensor data, as well as the fact that queries are temporal, existing flash index or file systems for general portable devices are not suitable for sensor networks. We propose Time-Log Tree (TL-Tree), a novel unbalanced and cascaded structure, that takes advantage of available flash capacity while making use of the time-series property as a primary feature for optimizing both memory and energy constraints. Extensive experiments show TL-Tree's ability to utilize both flash capacity and temporal locality to support sensor data processing. Compared to other schemes, it achieves much better access and energy savings for different kinds of random and temporal range queries. In addition, TL-Tree can also be easily extended to support value-based queries. We have developed a hardware board that includes a raw 128MB NAND flash chip on MicaZ mote. We have also implemented a flash driver and the TL-Tree to demonstrate the practicality of this idea.