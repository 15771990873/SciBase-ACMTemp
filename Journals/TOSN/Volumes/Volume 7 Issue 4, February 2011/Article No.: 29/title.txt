A security framework for privacy-preserving data aggregation in wireless sensor networks