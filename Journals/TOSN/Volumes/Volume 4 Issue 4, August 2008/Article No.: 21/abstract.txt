We consider wireless sensor networks with nodes switching ON (awake) and OFF (sleeping) to preserve energy, and transmitting data over channels with varying quality. The objective is to determine the best path from each node to a single gateway. The performance metrics we are interested in are: the expected energy consumption, and the probability that the latency exceeds a certain threshold. Under Markovian assumptions on the sleeping schedules and the channel conditions, we obtain the expected energy consumption of transmitting a packet on any path to the gateway. We also provide an upper (Chernoff) bound and a tight large deviations asymptotic for the latency probability on each path. To capture the trade-off between energy consumption and latency probability, we formulate the problem of choosing a path to minimize a weighted sum of the expected energy consumption and the exponent of the latency probability. We provide two algorithms to solve this problem: a centralized stochastic global optimization algorithm, and a distributed algorithm based on simulated annealing. The proposed methodology can also optimize over the fraction of time that sensor nodes remain ON (duty cycle).