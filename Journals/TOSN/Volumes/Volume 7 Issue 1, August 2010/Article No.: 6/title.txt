Reliable and efficient reprogramming in sensor networks