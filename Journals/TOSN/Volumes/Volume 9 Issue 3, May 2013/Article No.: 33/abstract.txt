Most Wireless Sensor Network (WSN) applications require distributed signal and collaborative data processing. One of the critical issues for enabling collaborative processing in WSNs is how to schedule tasks in a systematic way, including assigning tasks to sensor nodes, and determining their execution and communication sequence. Since WSN nodes are very resource constrained, mainly regarding their energy supply, one major concern when scheduling tasks in such environments is to minimize and balance the energy consumption, so that the system operational lifetime is maximized. We propose a heuristic-based three-phase algorithm (TPTS) for allocating tasks to multiple clusters in hierarchical WSNs that aims at finding a scheduling scheme that minimizes the overall energy consumption and balances the workload of the system while meeting the application's deadline. The performance of the proposed algorithm and the effect of several parameters on its behavior were evaluated by simulations, with promising results. The experimental results show that the time and energy performance of TPTS are close to the time and energy of benchmarks in most cases, while load balance is always provided.