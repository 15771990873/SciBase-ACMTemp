An approach to virtual allocation in storage systems