Niobe: A practical replication protocol