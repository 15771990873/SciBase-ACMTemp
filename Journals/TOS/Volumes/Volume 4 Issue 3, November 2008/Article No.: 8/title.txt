An analysis of data corruption in the storage stack