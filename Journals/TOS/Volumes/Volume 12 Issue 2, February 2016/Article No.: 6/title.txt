NANDFlashSim: High-Fidelity, Microarchitecture-Aware NAND Flash Memory Simulation