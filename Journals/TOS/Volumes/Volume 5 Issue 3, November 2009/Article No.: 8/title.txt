Divide-and-conquer scheme for strictly optimal retrieval of range queries