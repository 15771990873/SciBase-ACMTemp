Global illumination using local linear density estimation