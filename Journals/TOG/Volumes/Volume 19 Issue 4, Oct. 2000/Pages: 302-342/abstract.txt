Lighting simulations using hierarchical radiosity with clustering can be very slow when the computation of fine and artifact-free shadows is needed. To avoid the high cost of mesh refinement associated with fast variations of visibility across receivers, we propose a new hierarchical algorithm in which partial visibility maps can be computed on the fly, using a convolution technique for emitter-receiver configurations where complex  shadows are produced. Other configurations still rely on mesh subdivision to reach the desired accuracy in modeling energy transfer. In our system, therefore, radiosity is represented as a combination of textures and piecewise-constant or linear contributions over mesh elements at multiple hierarchical levels. We give a detailed description of thegather,push/pull, anddisplaystages of the hierarchical radiosity algorithm, adapted to seamlessly integrate both representations. A new refinement algorithm is proposed, which chooses the most appropriate technique to compute the energy transfer and resulting radiosity distribution for each receiver/transmitter configuration. Comprehensive error control is achieved by subdividing either the source or receiver in a traditional manner, or by using a blocker subdivision scheme that improves the quality of shadow masks without increasing the complexity of the mesh. Results show that high-quality images are obtained in a matter of seconds for scenes with tens of thousands of polygons.