Physically based modeling and animation of fire