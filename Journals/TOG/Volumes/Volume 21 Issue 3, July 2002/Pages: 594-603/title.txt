Robust treatment of collisions, contact and friction for cloth animation