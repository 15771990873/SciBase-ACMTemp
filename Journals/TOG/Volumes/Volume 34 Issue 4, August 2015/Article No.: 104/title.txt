Coupled segmentation and similarity detection for architectural models