Theory, analysis and applications of 2D global illumination