A theory of monte carlo visibility sampling