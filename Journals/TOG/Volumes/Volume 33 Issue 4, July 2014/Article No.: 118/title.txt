A comprehensive framework for rendering layered materials