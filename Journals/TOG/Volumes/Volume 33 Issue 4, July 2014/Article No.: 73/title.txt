Self-refining games using player analytics