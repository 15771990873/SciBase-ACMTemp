Panorama weaving: fast and flexible seam processing