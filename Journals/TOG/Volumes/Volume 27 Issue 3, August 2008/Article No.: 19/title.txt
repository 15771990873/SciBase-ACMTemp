BSGP: bulk-synchronous GPU programming