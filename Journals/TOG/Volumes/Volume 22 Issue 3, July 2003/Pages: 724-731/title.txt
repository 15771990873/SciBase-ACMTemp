Flows on surfaces of arbitrary topology