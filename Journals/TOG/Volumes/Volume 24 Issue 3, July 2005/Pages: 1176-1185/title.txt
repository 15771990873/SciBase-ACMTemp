Multi-level ray tracing algorithm