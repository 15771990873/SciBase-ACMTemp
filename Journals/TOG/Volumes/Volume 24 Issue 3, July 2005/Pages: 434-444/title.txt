RPU: a programmable ray processing unit for realtime ray tracing