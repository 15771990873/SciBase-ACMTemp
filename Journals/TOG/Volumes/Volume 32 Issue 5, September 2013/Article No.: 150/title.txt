Geometry and context for semantic correspondences and functionality recognition in man-made 3D shapes