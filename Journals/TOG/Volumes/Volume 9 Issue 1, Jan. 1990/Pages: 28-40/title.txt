Performing geometric transformations by program transformation