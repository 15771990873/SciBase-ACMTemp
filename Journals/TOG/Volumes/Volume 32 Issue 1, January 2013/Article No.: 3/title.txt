Synthesis of tiled patterns using factor graphs