An optimization approach for extracting and encoding consistent maps in a shape collection