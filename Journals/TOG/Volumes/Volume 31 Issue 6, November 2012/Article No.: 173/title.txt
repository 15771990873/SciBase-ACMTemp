A vectorial solver for free-form vector gradients