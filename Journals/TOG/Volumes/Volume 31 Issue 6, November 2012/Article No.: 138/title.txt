Acquiring 3D indoor environments with variability and repetition