Using program transformations to derive line-drawing algorithms