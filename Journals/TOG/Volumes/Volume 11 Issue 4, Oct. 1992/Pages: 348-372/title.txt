Color quantization by dynamic programming and principal analysis