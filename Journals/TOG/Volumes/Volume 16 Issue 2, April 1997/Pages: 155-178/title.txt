An optimal algorithm for expanding the composition of polynomials